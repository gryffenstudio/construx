---
import Service from '../components/Service.astro';
import Layout from '../layouts/Layout.astro';
import residentialHomeSvg from '../assets/svg/residential-home-service.svg?raw';
import Hero from '../components/Hero.astro';
import heroImageSM from '../assets/images/Home-Hero-SM.png';
import heroImage from '../assets/images/home-hero.png';
---

<Layout title='Services - Construx' description='Build with Construx' robots={false}>
    <Hero
        h1Text='our services'
        description='We provide the best services for our customers'
        heroImages={[heroImageSM, heroImage]}
    />
    <main>
        <section class='bg-brand-gray'>
            <div class='container py-16 lg:flex lg:justify-between'>
                <h2
                    class='text-left text-[32px] font-semibold normal-case leading-[45px] first-letter:capitalize lg:w-1/3 lg:text-[40px]'
                >
                    what we offer to our clients
                </h2>
                <p class='mt-4 capitalize leading-[30px] lg:mt-0 lg:w-1/2'>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                    incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
                    nostrud exercitation ullamco la
                </p>
            </div>
            <div class='container pb-16'>
                <div
                    class='grid place-items-center gap-y-12 py-8 lg:grid-cols-2 lg:gap-x-4 lg:gap-y-4 xl:grid-cols-3'
                >
                    <Service
                        icon={residentialHomeSvg}
                        service='build your home'
                        description='Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. '
                    />
                    <Service
                        icon={residentialHomeSvg}
                        service='build your home'
                        description='Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.'
                    />
                    <Service
                        icon={residentialHomeSvg}
                        service='build your home'
                        description='Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. '
                    />
                    <Service
                        icon={residentialHomeSvg}
                        service='build your home'
                        description='Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. '
                    />
                    <Service
                        icon={residentialHomeSvg}
                        service='build your home'
                        description='Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. '
                    />
                    <Service
                        icon={residentialHomeSvg}
                        service='build your home'
                        description='Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. '
                    />
                </div>
            </div>
        </section>
        <section class='container py-16'>
            <h2
                class='mb-8 text-left text-[32px] font-semibold leading-[45px] first-letter:capitalize lg:w-[40%] lg:text-[40px]'
            >
                Want to know how we plan?
            </h2>
            <h3
                class='mb-5 text-xl font-bold capitalize leading-loose text-brand-green-primary lg:text-center'
            >
                planning process
            </h3>
            <div class='relative'>
                <div
                    class='absolute z-0 min-h-full min-w-[5px] rounded-full bg-[#d9d9d9] lg:right-[50%]'
                >
                    <div
                        id='progress-bar'
                        class='absolute top-0 z-10 h-[13%] w-[5px] rounded-full bg-brand-green-primary'
                    >
                    </div>
                </div>

                <div class='planning-section'>
                    <span
                        class='icon-[fluent--number-circle-1-16-filled] h-12 w-12 bg-brand-green-primary'
                    ></span>
                    <h4 class='text-2xl font-bold capitalize leading-loose'>develop objectives</h4>
                    <p class='capitalize'>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                        adipiscing elit, sed do eiusmod Lorem ipsum dolor sit amet, consectetur
                        adipiscing elit, sed do eiusmod adipiscing elit.
                    </p>
                </div>
                <div class='planning-section opacity-10'>
                    <span
                        class='icon-[fluent--number-circle-2-16-filled] h-12 w-12 bg-brand-green-primary'
                    ></span>
                    <h4 class='text-2xl font-bold capitalize leading-loose'>develop objectives</h4>
                    <p class='capitalize'>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                        adipiscing elit, sed do eiusmod Lorem ipsum dolor sit amet, consectetur
                        adipiscing elit, sed do eiusmod adipiscing elit.
                    </p>
                </div>
                <div class='planning-section opacity-10'>
                    <span
                        class='icon-[fluent--number-circle-3-16-filled] h-12 w-12 bg-brand-green-primary'
                    ></span>
                    <h4 class='text-2xl font-bold capitalize leading-loose'>develop objectives</h4>
                    <p class='capitalize'>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                        adipiscing elit, sed do eiusmod Lorem ipsum dolor sit amet, consectetur
                        adipiscing elit, sed do eiusmod adipiscing elit.
                    </p>
                </div>
                <div class='planning-section opacity-10'>
                    <span
                        class='icon-[fluent--number-circle-4-16-filled] h-12 w-12 bg-brand-green-primary'
                    ></span>
                    <h4 class='text-2xl font-bold capitalize leading-loose'>develop objectives</h4>
                    <p class='capitalize'>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                        adipiscing elit, sed do eiusmod Lorem ipsum dolor sit amet, consectetur
                        adipiscing elit, sed do eiusmod adipiscing elit.
                    </p>
                </div>
                <div class='planning-section'>
                    <span
                        class='icon-[fluent--number-circle-5-16-filled] h-12 w-12 bg-brand-green-primary'
                    ></span>
                    <h4 class='text-2xl font-bold capitalize leading-loose'>develop objectives</h4>
                    <p class='capitalize'>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                        adipiscing elit, sed do eiusmod Lorem ipsum dolor sit amet, consectetur
                        adipiscing elit, sed do eiusmod adipiscing elit.
                    </p>
                </div>
                <div class='planning-section opacity-10'>
                    <span
                        class='icon-[fluent--number-circle-6-16-filled] h-12 w-12 bg-brand-green-primary'
                    ></span>
                    <h4 class='text-2xl font-bold capitalize leading-loose'>develop objectives</h4>
                    <p class='capitalize'>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                        adipiscing elit, sed do eiusmod Lorem ipsum dolor sit amet, consectetur
                        adipiscing elit, sed do eiusmod adipiscing elit.
                    </p>
                </div>
                <div class='planning-section opacity-10'>
                    <span
                        class='icon-[fluent--number-circle-7-16-filled] h-12 w-12 bg-brand-green-primary'
                    ></span>
                    <h4 class='text-2xl font-bold capitalize leading-loose'>develop objectives</h4>
                    <p class='capitalize'>
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
                        adipiscing elit, sed do eiusmod Lorem ipsum dolor sit amet, consectetur
                        adipiscing elit, sed do eiusmod adipiscing elit.
                    </p>
                </div>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const progressBar = document.getElementById('progress-bar');
            if (!progressBar) {
                return;
            }

            const sections = document.querySelectorAll('.planning-section');
            const progressBarContainer = progressBar.parentElement;

            if (!progressBarContainer) {
                return;
            }

            const containerHeight = progressBarContainer.offsetHeight;
            const sectionHeight = containerHeight / sections.length;

            let lastCurrentIndex = 0;
            let isAnimating = false;

            function updateProgressBar() {
                const scrollPosition = window.scrollY;
                const windowHeight = window.innerHeight;

                let currentIndex = -1;

                sections.forEach(function (section, index) {
                    const sectionTop = section.getBoundingClientRect().top + scrollPosition;
                    const sectionHeight = section.clientHeight;

                    if (
                        scrollPosition + windowHeight / 2 >= sectionTop &&
                        scrollPosition + windowHeight / 2 < sectionTop + sectionHeight
                    ) {
                        currentIndex = index;
                    }
                });

                if (currentIndex !== -1 && !isAnimating && progressBar) {
                    if (currentIndex !== lastCurrentIndex) {
                        isAnimating = true;

                        // Handle stretching for scrolling down
                        if (currentIndex > lastCurrentIndex) {
                            progressBar.classList.add('stretchingNext');
                            progressBar.classList.remove('stretchingLast');
                        }
                        // Handle stretching for scrolling up
                        else {
                            progressBar.classList.add('stretchingLast');
                            progressBar.classList.remove('stretchingNext');
                        }

                        setTimeout(() => {
                            let newTop = sectionHeight * currentIndex;
                            newTop = Math.max(
                                0,
                                Math.min(newTop, containerHeight - progressBar.offsetHeight),
                            );

                            progressBar.style.top = `${currentIndex <= 2 ? newTop : newTop + 22}px`;

                            sections.forEach((sec, secIndex) => {
                                if (secIndex === currentIndex) {
                                    sec.classList.remove('opacity-10');
                                } else {
                                    sec.classList.add('opacity-10');
                                }
                            });

                            lastCurrentIndex = currentIndex;
                            progressBar.classList.remove('stretchingNext', 'stretchingLast');
                            isAnimating = false;
                        }, 300); // Half of the animation duration
                    }
                }
            }

            window.addEventListener('scroll', updateProgressBar);
            updateProgressBar(); // Initial update
        });
    </script>
</Layout>
